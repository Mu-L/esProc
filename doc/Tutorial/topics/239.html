<!--create by iword1.0 pro, http://www.voland.com.cn-->
<!-- saved from url=(0026)http://www.runqian.com.cn/ -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>9.4.1 Basic uses</title>
<link rel="stylesheet" href="../images/template.css" type="text/css" />
<link rel="stylesheet" href="document.css" type="text/css" />
<script language="JavaScript" src="../resource/url.js"></script>
</head>

<body>

<div id="content-bg">
	<div id="centent">
	<div id="centent-title"><h3 style='margin-left:0cm;text-indent:0cm;mso-list:none'><span lang=EN-US>9.4.1
Basic uses</span></h3></div>
	<p class=T-Par style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>esProc supports querying TXT and CSV files directly. It uses the
SQL-like database statements to do that. We call it <b style='mso-bidi-font-weight:
normal'>simple SQ</b>L, and the TXT and CSV files, which are external data that
is queryable as table sequences, the <b style='mso-bidi-font-weight:normal'>external
table</b>s. For example:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:19.35pt;border-collapse:collapse;mso-table-layout-alt:fixed;
 border:none;mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:
 #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:.5pt solid #B2B2B2;
 mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 valign=top style='width:31.2pt;border:solid black 1.0pt;
  mso-border-alt:solid black .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='text-align:justify;text-justify:inter-ideograph;
  line-height:16.0pt;mso-line-height-rule:exactly'><span lang=EN-US>&nbsp;</span></p>
  </td>
  <td width=907 valign=top style='width:340.15pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid black 1.0pt;
  mso-border-left-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>1</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:windowtext;mso-border-left-alt:windowtext;mso-border-bottom-alt:
  #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
  .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$()select * from
  cities.txt</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel0><span lang=EN-US>2</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select * from
  D:/files/txt/cities.txt where STATEID=5</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLaEnd10><span lang=EN-US>3</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select STATEID,
  count(*) AS Cities from cities.txt group by STATEID</span></p>
  </td>
 </tr>
</table>

<p class=T-ParCxSpFirst style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>Similar to a database SQL query with data source connected, esProc
writes the simple SQL statement directly after the dollar sign ($) to query
data from an external table. If a database connection exists, the statement
after $ will by default executed in the database. To use simple SQL to query
data in an external file, we can add () after the dollar sign $. Below is A1¡¯s
result set of querying <i style='mso-bidi-font-style:normal'>cities.txt</i>:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:
#0400'><img border=0 width=1000 height=462
src="Tutorial.files/image1978.jpg" v:shapes="_x0000_i2098"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>The simple SQL statement in A1 directly uses the file name instead
of a specific table name. That¡¯s the difference from a SQL statement. The file
should be in esProc¡¯s main path if the file path isn¡¯t explicitly written. In
the query, the type of file used is determined by its extension. A simple SQL
statement supports using text files with txt or csv extension, Excel files with
xls or xlsx extension, and bin files with the btx extension.</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>You can set a filtering condition where or calculate aggregate in a
simple SQL statement. For example, A2 gets city records where STATEID is 5; and
A3 counts the cities in each group of state records. Below are their result
sets:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:
#0400'><img border=0 width=962 height=242
src="Tutorial.files/image1980.jpg" v:shapes="_x0000_i2099"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-ansi-language:#0400;mso-fareast-language:
#0400'><img border=0 width=1000 height=462
src="Tutorial.files/image1982.jpg" v:shapes="_x0000_i2100"></span></p>

<p class=T-ParCxSpLast style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US>Similar to the usual SQL syntax, an aggregate function performing
the corresponding aggregate operation needs to work with the <span
class=T-Bold>group by</span> clause that performs the grouping operation.
Besides the count aggregation function, we can use <span class=T-Bold>sum/max/min/distinct
</span><span class=T-Bold><span style='font-weight:normal;mso-bidi-font-weight:
bold'>function in a simple SQL statement.</span></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt;mso-char-indent-count:2.0'><span
lang=EN-US>The file name of an external table in a simple SQL statement can be
represented by a full path, like the one A2 uses.</span></p>

<p class=T-Par style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>Query data in an external table
and return part of the data:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:19.85pt;border-collapse:collapse;mso-table-layout-alt:fixed;
 border:none;mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:
 #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:.5pt solid #B2B2B2;
 mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 valign=top style='width:31.2pt;border:solid black 1.0pt;
  mso-border-alt:solid black .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>&nbsp;</span></p>
  </td>
  <td width=907 valign=top style='width:340.15pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid black 1.0pt;
  mso-border-left-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>1</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:windowtext;mso-border-left-alt:windowtext;mso-border-bottom-alt:
  #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
  .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select top 5 CID,
  NAME, POPULATION from cities.txt</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>2</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select CID, NAME,
  POPULATION from cities.txt limit 2 offset 3</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLaEnd style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US>3</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select * from
  cities.txt where STATEID &lt; 20 and POPULATION&lt;300000</span></p>
  </td>
 </tr>
</table>

<p class=T-ParCxSpFirst style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>A1 retrieves the first n records
using <span class=T-Bold>top <i>n</i></span>:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=958 height=242
src="Tutorial.files/image1984.jpg" v:shapes="_x0000_i2101"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>A2 performs page skipping query
using <span class=T-Bold>limit <i>n</i> offset <i>m</i></span>, which skips the
first <span class=T-Bold><i>m </i></span>records to retrieve <span
class=T-Bold><i>n </i></span>records. Below is the result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=958 height=122
src="Tutorial.files/image1986.jpg" v:shapes="_x0000_i2102"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>Actually, a <span class=T-Bold>where</span>
filtering operation can also return part of data. Like the SQL rule, connect
multiple filtering conditions, if there are any, with <span class=T-Bold>and</span>.
Logical operators, such as <span class=T-Bold>or/not</span>, can also be used
as needed. Below is A3¡¯s result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=958 height=282
src="Tutorial.files/image1988.jpg" v:shapes="_x0000_i2103"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>

<p class=T-ParCxSpLast style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>In a simple SQL statement, we can
specify an alias for a table or field to be queried. For example:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:19.85pt;border-collapse:collapse;mso-table-layout-alt:fixed;
 border:none;mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:
 #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:.5pt solid #B2B2B2;
 mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 valign=top style='width:31.2pt;border:solid black 1.0pt;
  mso-border-alt:solid black .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>&nbsp;</span></p>
  </td>
  <td width=907 valign=top style='width:340.15pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid black 1.0pt;
  mso-border-left-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>1</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:windowtext;mso-border-left-alt:windowtext;mso-border-bottom-alt:
  #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
  .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select CID as ID,
  NAME as CITY, POPULATION as POP from cities.txt</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>2</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select CID ID, NAME
  CITY, POPULATION POP from cities.txt</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>3</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select distinct
  _file, _ext, _size, _date from cities.txt</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLaEnd style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US>4</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>=A3.derive(datetime(_date):date)</span></p>
  </td>
 </tr>
</table>

<p class=T-ParCxSpFirst style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>Like the SQL syntax, SPL can use
keyword as to set an alias or just omit it. A1 and A2 return the same result,
as shown below:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=992 height=462
src="Tutorial.files/image1990.jpg" v:shapes="_x0000_i2104"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>In addition to fields of a data
table, the simple SQL can be used to query file information. _file, _ext, _size
and _date respectively return a file¡¯s name, extension, size and the last
modified time, and keyword distinct removes duplicate information. A3 gets the
following result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=954 height=86
src="Tutorial.files/image1992.jpg" v:shapes="_x0000_i2105"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>A4 converts the last modified time
to a date type time and gets the following result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=954 height=86
src="Tutorial.files/image1994.jpg" v:shapes="_x0000_i2106"></span></p>

<p class=T-ParCxSpLast style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>In a simple SQL statement, we can
use a subclause, such as join/left join/right join/full join, to connect
multiple tables to perform a multi-table query. For example:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:19.85pt;border-collapse:collapse;mso-table-layout-alt:fixed;
 border:none;mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:
 #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:.5pt solid #B2B2B2;
 mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 valign=top style='width:31.2pt;border:solid black 1.0pt;
  mso-border-alt:solid black .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>&nbsp;</span></p>
  </td>
  <td width=907 valign=top style='width:340.15pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid black 1.0pt;
  mso-border-left-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>1</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:windowtext;mso-border-left-alt:windowtext;mso-border-bottom-alt:
  #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
  .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$()select * from
  states.txt</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>2</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select C.CID as ID,
  C.NAME as City, C.POPULATION as Pop, S.NAME as STATE<span
  style='mso-spacerun:yes'>&nbsp; </span>from cities.txt C join states.txt S on
  C.STATEID = S.STATEID</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>3</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select C.CID as ID,
  C.NAME as City, C.POPULATION as Pop, S.NAME as STATE<span
  style='mso-spacerun:yes'>&nbsp; </span>from cities.txt C full join states.txt
  S on C.STATEID = S.STATEID</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLaEnd style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US>4</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$()select C.CID as ID,
  C.NAME as City, C.POPULATION as Pop, S.NAME as STATE<span
  style='mso-spacerun:yes'>&nbsp; </span>from cities.txt C left join states.txt
  S on C.STATEID = S.STATEID</span></p>
  </td>
 </tr>
</table>

<p class=T-ParCxSpFirst style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>Check A1¡¯s result set and we can
see that <i>states.txt</i> stores some state information:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=958 height=242
src="Tutorial.files/image1996.jpg" v:shapes="_x0000_i2107"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>A2, A3 and A4 perform join queries
&#8211; inner join, full join and left join respectively, on cities table and states
table, and get the following results:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=958 height=442
src="Tutorial.files/image1998.jpg" v:shapes="_x0000_i2108"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=996 height=464
src="Tutorial.files/image2000.jpg" v:shapes="_x0000_i2109"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=996 height=464
src="Tutorial.files/image2002.jpg" v:shapes="_x0000_i2110"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>

<p class=T-ParCxSpLast style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>When performing a grouping
operation, we can use <span class=T-Bold>group by <i>n </i></span>to specify
the <span class=T-Bold><i>n</i></span>th field or expression used in the select
statement as the grouping field/expression. For example:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:19.85pt;border-collapse:collapse;mso-table-layout-alt:fixed;
 border:none;mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:
 #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:.5pt solid #B2B2B2;
 mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 valign=top style='width:31.2pt;border:solid black 1.0pt;
  mso-border-alt:solid black .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>&nbsp;</span></p>
  </td>
  <td width=907 valign=top style='width:340.15pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid black 1.0pt;
  mso-border-left-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>1</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:windowtext;mso-border-left-alt:windowtext;mso-border-bottom-alt:
  #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
  .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select STATEID,
  count(*) Cities from cities.txt group by STATEID</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>2</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select STATEID,
  count(*) Cities from cities.txt group by 1</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>3</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select STATEID,
  count(*) Cities from cities.txt group by STATEID having Cities &gt; 1</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLaEnd style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US>4</span></p>
  </td>
  <td width=907 style='width:340.15pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select STATEID,
  count(*) Cities from cities.txt group by STATEID having Cities &gt; 1 order
  by Cities</span></p>
  </td>
 </tr>
</table>

<p class=T-ParCxSpFirst style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>A2 gets the same result as A1:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=1000 height=462
src="Tutorial.files/image1982.jpg" v:shapes="_x0000_i2111"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>A3 uses having clause to perform a
filtering during the grouping operation and returns the following result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=954 height=206
src="Tutorial.files/image2004.jpg" v:shapes="_x0000_i2112"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>A4 uses order by clause to sort
the result set after A4¡¯s grouping and filtering operations, and get the
following result:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=954 height=206
src="Tutorial.files/image2006.jpg" v:shapes="_x0000_i2113"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>As the syntax group by n, we can
write order by clause as <span class=T-Bold>order by <i>n</i></span> to sort
records, where n is the ordinal number of a field in the select statement.</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>&nbsp;</span></p>

<p class=T-ParCxSpLast style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>We can use wildcard characters in
a simple SQL statement to query desired data from multiple external files
having similar names and same structure. For example:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:19.85pt;border-collapse:collapse;mso-table-layout-alt:fixed;
 border:none;mso-border-top-alt:black;mso-border-left-alt:black;mso-border-bottom-alt:
 #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
 .5pt;mso-padding-alt:0cm 0cm 0cm 0cm;mso-border-insideh:.5pt solid #B2B2B2;
 mso-border-insidev:.5pt solid #B2B2B2'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 valign=top style='width:31.2pt;border:solid black 1.0pt;
  mso-border-alt:solid black .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>&nbsp;</span></p>
  </td>
  <td width=605 valign=top style='width:226.75pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid black 1.0pt;
  mso-border-left-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-bottom-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>A</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>1</span></p>
  </td>
  <td width=605 style='width:226.75pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-top-alt:windowtext;mso-border-left-alt:windowtext;mso-border-bottom-alt:
  #B2B2B2;mso-border-right-alt:#B2B2B2;mso-border-style-alt:solid;mso-border-width-alt:
  .5pt;background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$(demo) select * from
  STATES where STATEID&lt;5</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>2</span></p>
  </td>
  <td width=605 style='width:226.75pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select * from STATES
  where STATEID&gt;10 and STATEID&lt;15</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>3</span></p>
  </td>
  <td width=605 style='width:226.75pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:white;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$()select * into
  statePart1.txt from {A1}</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;page-break-inside:avoid;height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLabel style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US style='font-size:9.0pt'>4</span></p>
  </td>
  <td width=605 style='width:226.75pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:white;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select * into
  statePart2.txt from {A2}</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5;mso-yfti-lastrow:yes;page-break-inside:avoid;
  height:14.15pt'>
  <td width=83 style='width:31.2pt;border-top:none;border-left:solid black 1.0pt;
  border-bottom:solid black 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid black .5pt;mso-border-alt:solid black .5pt;
  mso-border-right-alt:solid windowtext .5pt;background:#DDDDDD;padding:0cm 0cm 0cm 0cm;
  height:14.15pt'>
  <p class=TabLaEnd style='line-height:16.0pt;mso-line-height-rule:exactly'><span
  lang=EN-US>5</span></p>
  </td>
  <td width=605 style='width:226.75pt;border-top:none;border-left:none;
  border-bottom:solid #B2B2B2 1.0pt;border-right:solid #B2B2B2 1.0pt;
  mso-border-top-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid #B2B2B2 .5pt;mso-border-left-alt:solid windowtext .5pt;
  background:#FFFF99;padding:0cm 0cm 0cm 0cm;height:14.15pt'>
  <p class=TabCode style='text-align:justify;text-justify:inter-ideograph'><span
  lang=EN-US style='font-family:"Times New Roman",serif'>$select * from
  statePart*.txt</span></p>
  </td>
 </tr>
</table>

<p class=T-ParCxSpFirst style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>A1 and A2 respectively query
certain states information from database demo, and get the following results:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=958 height=202
src="Tutorial.files/image2008.jpg" v:shapes="_x0000_i2114"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=958 height=202
src="Tutorial.files/image2010.jpg" v:shapes="_x0000_i2115"></span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>A3 and A4 use <span class=T-Bold>select¡­
into </span>subclause to store A1¡¯s data and A2¡¯s data to external files statePart1.txt
and statePart2.txt respectively, and determine file types according to file
extensions. Since the previous query is a database one, A3 needs to begin the
simple SQL statement querying an external file with <span class=T-Bold>$()</span>.
In the simple SQL statement, an esProc expression referenced should be enclosed
by <span class=T-Bold>{}</span>. To call A1¡¯s result table sequence using {A1},
for example:</span></p>

<p class=T-ParCxSpMiddle style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US style='mso-bidi-font-size:10.5pt'>A5 performs wildcard matching to
retrieve records from data files whose names match statePart*.txt, and
concatenate them. Here these files must have the same structure. Below is A5¡¯s
result:</span></p>

<p class=T-ParCxSpLast style='text-align:justify;text-justify:inter-ideograph;
text-indent:21.0pt'><span lang=zh-CN style='mso-bidi-font-size:10.5pt;
mso-ansi-language:#0400;mso-fareast-language:#0400'><img border=0 width=958 height=362
src="Tutorial.files/image2012.jpg" v:shapes="_x0000_i2116"></span></p>
	</div>
	<div id="previous-next">
		<div id="next"><a href="240.html">Next</a></div>
		<div id="previous"><a href="238.html">Previous</a></div>		
	</div>
	<div id="related">
		<div class="related-title"><div class="related-title-left"></div>   Related :</div>
		<div class="related-list"><li><span style='font-family:ËÎÌå;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'><a href="238.html">9.4 Simple SQL</a></span></li>
</div>
	</div>
	<div id="footer">	
		
		
    <div class="copyright"> Copyright&reg; 2021-2025 <a href="http://www.esproc.com" target="_Blank">SCUDATA Ltd. 
      </a></div>
	</div>
</div>

</body>
</html>
